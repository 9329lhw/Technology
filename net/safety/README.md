# 网络安全

1. xss
    - 1.1 原理
        > 跨站脚本攻击XSS（Cross Site Scripting）恶意攻击者往Web页面里插入恶意Script代码，当用户浏览该页之时，嵌入其中Web里面的Script代码会被执行，从而达到恶意攻击用户的目的
    - 1.2 XSS注入点
        - 1.2.1.HTML节点内容()
            ```
            <div>#{content}</div>
            <div><script>alert(1)</script></div>
             ```         
        - 1.2.2.HTML属性(提前终止属性)
            ```
            <img src="#{image}" />
            <img src="1" οnerrοr="alert(1)"/>
            ```
        - 1.2.3.Javascript代码（字符串提前关闭）
        ```<script type="text/javascript">
            var data = "#{data}";
            var data = "hello";
            alert(1);"";
            </script>```
            
        - 1.2.4.富文本
        ```
        浏览器自带防御,反射性XSS（HTML内容和属性)上面的参数出现在HTML内容或属性两种攻击     
        ctx.set('X-XSS-Protection',1);
        ```
    - 1.3 预防  
    ```
    对数据进行转义（如：>、<、'、"）、HTML白名单机制、第三方库、CSP策略
    ```
2. csrf
    - 2.1 原理
    >跨站请求伪造（Cross Site Request Forgy）：攻*击者利用普通用户的身份，以普通用户的名义向目标网站发起某些非法操作
    （前提：1.普通用户已访问目标网站，目标网站返回cookie等信息  2.普通用户访问了攻*击者的链接）
    - 2.2 预防
    ```
    禁止第三方网站带cookie（禁止referer为其它网站的请求）、same-site属性、  
    请求附加验证码或token等
    1.禁止第三方网站带Cookies (设置 same-site目前就谷歌浏览器支持)
    2.网站提交时验证码
    3.网站加token(<meta name="csrf-token" content="{{ csrf_token() }}">) 
        ps:需要注意多Token覆盖的问题
    4.验证referer(禁止第三方网站的请求)
    ```
3. 点击劫持
    - 3.1 原理
    >也被称为UI-覆盖攻*击，是指攻*击者将内嵌框架透明化，普通用户以为点击了所看到的页面，实则点击了攻*击者注入了恶意代码的页面
    - 3.2 预防
    ```
    JavaScript禁止内嵌、X-FRAME-OPTIONS禁止内嵌、其他辅助手段
    ```
4. 传输安全
    - 4.1 http窃听
    - 4.2 http篡改
5. 中间人攻击
    >中间人攻击（Man-in-the-MiddleAttack，简称“MITM攻击”）是一种“间接”的入侵攻击，这种攻击模式是通过各种技术手段将受入侵者控制的
    一台计算机虚拟放置在网络连接中的两台通信计算机之间，这台计算机就称为“中间人”。
6. 密码攻击
    >密码攻击是在不知道密匙的情况下，恢复出明文。常用的密码分析攻击有惟密
    文攻击(Ciphertext Only Attack)、选择明文攻击(Chosen Plaintext Attack)、
    选择密文攻击(Chosen Ciphertext Attack) 和相关键值攻击(Related Key Attack) 四大类。
7. sql注入
    - 7.1 定义
    Web应用程序未对前端传入后端的参数进行合法性校验，
    并且参数带入数据库查询，攻击者通过构造不同的SQL语句来实现对数据库的攻击
    - 7.2 示例
    ```
    select * from table where id = ${id};   
    --->     
    select * from table where id = 1 or 1 = 1;
    ```
    - 7.3 预防
    ```
    关闭错误输出、检查数据类型、对数据进行转义、
    使用参数化查询、使用ORM（对象关系映射）
    ```
8. 文件上传
    - 8.1 原理
    >攻击者通过上传可执行文件到服务端，来获取网站的权限，进而控制服务器
    - 8.2 预防
    ```
    限制上传文件的后缀、文件类型检查、文件内容检查、
    程序输出、权限控制-可写可执行互斥
    ```
9. dos攻击
    - 9.1 定义
    >DOS/DDOS并不是一种入侵的操作，而系统及软件漏洞才是赤裸裸的攻击，通过攻击可以操作你的服务器获取相应的权限等等
    - 9.2 案例
    ```
    心血漏洞（ssh服务），
    redies漏洞，
    bash漏洞等等，
    这些漏洞都会导致你的服务器被黑客入侵
    ```

10. 重放攻击
    - 10.1 定义
    >入侵者从网络上截取主机A发送给主机B的报文，并把由A加密的报文发送给B，
    使主机B误以为入侵者就是主机A，然后主机B向伪装成A的入侵者发送应当发送给A的报文
    用户被多次消费、用户登录状态被盗取、多次抽奖
    - 10.2 预防
        - 10.2.1.加随机数
        - 10.2.2.加时间戳
        - 10.2.3.加流水号
        - 10.2.4.加密（HTTPS）、时间戳、token（session）、nonce、签名
11. [cc攻击](https://baike.baidu.com/item/cc%E6%94%BB%E5%87%BB/10959545?fr=aladdin)
    - 11.1 定义
    - 11.2 预防
        - 11.2.1 服务器垂直扩展和水平扩容
        - 11.2.2 数据缓存(内存级别，不要用文件)
        - 11.2.3 页面静态化
        - 11.2.4 用户级别的调用频率限制
        - 11.2.5 IP限制(nginx中可配置)
12. ARP欺骗
    >由于局域网的网络流通不是根据IP地址进行，而是根据MAC地址进行传输。
    所以，MAC地址在A上被伪造成一个不存在的MAC地址，
    这样就会导致网络不通，A不能Ping通C！这就是一个简单的ARP欺骗。
13. IP欺骗
    >IP地址欺骗是指行动产生的IP数据包为伪造的源IP地址，以便冒充其他系统或发件人的身份。这是一种黑客的攻击形式，
    黑客使用一台计算机上网,而借用另外一台机器的IP地址,从而冒充另外一台机器与服务器打交道。